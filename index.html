<!DOCTYPE html>
<html>
  <head>
  
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
    <title>Тестовое задание</title>
		
    <script src="https://vk.com/js/api/openapi.js?154" type="text/javascript"></script>
		
    <script type="text/javascript">
	
      VK.init({
        apiId: 6604866
      });
	  
    </script>		
		
  </head>
  
  <body>
  
  <style>
            
  </style> 

  <script src="https://code.jquery.com/jquery-1.8.3.js"></script>
<script src="./carhartl-jquery-cookie-92b7715/jquery.cookie.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/css/materialize.min.css">

    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/js/materialize.min.js"></script>
  <a class="waves-effect waves-light btn" id="btn">button</a>

  <div id="about">
  <div>ваши друзья</div>
  
  <ul id="frends">
  
  </ul>
  </div>
    <script type="text/javascript">
	
      var loginInVK = function (){
	  
		  VK.Auth.login(function(response) {
		
			if (response.session) {
		  
			  console.log(response);
	  
			  VK.Api.call('friends.get', {fields: ['uid', 'first_name', 'last_name','crop_photo'], order: 'name',v:"5.73"}, function(r){
			
				console.log(r);
			
				if(r.response) {
			
				  r = r.response.items;
			  
				  for( var i = 0 ; i < Math.min(r.length,5) ; ++i ){
			 
					$("#frends").append("<li class='item'>"+r[i].first_name+" "+r[i].last_name+" "+r[i].id+"</li>");
			 
				  }
			  
			   }else alert("Не удалось получить список ваших друзей(((");
			 
			  })
		   
			}else alert("Не удалось получить доступ");
		 
		  },2);
		  
    }
	
	var createCookie = function(){
	
	  $.cookie('authorization', '1', {
	  
      expires: 5,
      path: '/',
      secure: true
	  
      });	
	}
	
	var checkCookie = function(){
	
	  if($.cookie('authorization') == '1')
	    return true;
	  else
	    return false;
	}
	
	//loginInVK();

	$( document ).ready(function() {
	
      if(checkCookie()){
	  
	    loginInVK();
	    $('#btn').hide();
		$('#about').show();
		
	  }else{
	    $('#about').hide();
		$('#btn').show();
	  }
	 
    });
	
	$('#btn').click({
	
	  createCookie();
	  loginInVK();
	  $('#btn').hide();
      $('#about').show();
	
	})
	
  </script>
  
  </body>
</html>